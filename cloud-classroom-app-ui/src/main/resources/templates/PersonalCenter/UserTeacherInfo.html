

<div class="title">
	 <span class="dot left"></span>
           <h3>个人资料</h3>
</div>
                <h4 class="red">*必填</h4>
                <form action="/userui/uploadTeacher" method="post" enctype="multipart/form-data" target="hidden_frame" id="teacherForm"> 
                <table class="required">
                	<tbody>
                	<tr>
                		<td class="td-text">用户名：</td>
                		<td class="td-sr">
                		<input class="td-input input85 td-border gray-bgc" 
                		type="text" 
                		th:value="${user.userName}" 
                		disabled="disabled">
                		</input>
                		</td>
                		<td class="td-zs">
                		    <button id="edit" type="button" class="blue" onclick="javascript:makeEditable()"><i class="fa fa-pencil-square-o mar5 size-2o"></i>编辑</button>
                		</td>
                	</tr>
                	<tr>
                		<td class="td-text">昵称：</td>
                		<td class="td-sr">
                		    <input class="td-input input85 td-border" 
                		    type="text"  
                		    th:value="${user.nickName}==null?'':${user.nickName}" 
                		    id="nickName" 
                		    name="nickName" 
                		    disabled="true">
                		    </input>
                		</td>
                	</tr>
                	<tr>
                		<td class="td-text">姓名：</td>
                		<td class="td-sr"><input class="td-input input85 td-border" type="text" th:value="${user.name}==null?'':${user.name}" id="name" name="name" disabled="true"  onblur="checkName()"></input></td>
                		<td class="td-text" id="nameMessage"></td>
                	</tr>
                	<tr>
                		<td class="td-text">性别：</td>
                		<td class="td-sr">
                		    <div th:if="${user.sex==0}">
                			<input type="radio" name="sex" value="0" id="male" disabled="true"  checked="checked"/>
                			<label for="female">男</label>
                			<input type="radio"  value="1" id="female"  name="sex" disabled="true" />
                            <label for="male">女</label>
                            </div>
                            <div th:if="${user.sex==1}">
                			<input type="radio" name="sex" value="0"  id="male" disabled="true"/>
                			<label for="female">男</label>
                			<input type="radio"  value="1" id="female"  name="sex" disabled="true" checked="checked" />
                            <label for="male">女</label>
                            </div>
                           <div th:if="${user.sex==null}">
                			<input type="radio" name="sex" value="0"  id="male" disabled="true"/>
                			<label for="female">男</label>
                			<input type="radio"  value="1" id="female"  name="sex" disabled="true" checked="checked" />
                            <label for="male">女</label>
                            </div>
                		</td>
                	</tr>
                	<tr>
                		<td class="td-text">手机：</td>
                		<td class="td-sr"><input class="td-input input85 td-border" type="text" id="phone" th:value="${user.phone}==null?'':${user.phone}" name="phone" disabled="true" onblur="checkPhone()"></input></td>
                		<td class="td-text" id="phoneMessage"></td>
                	</tr>
                	<tr>
                		<td class="td-text">邮箱：</td>
                		<td class="td-sr"><input class="td-input input85 td-border" type="text" id="email"  th:value="${user.email}==null?'':${user.email}" name="email" disabled="true" onblur="checkEmail()"></input></td>
                		<td class="td-text" id="emailMessage"></td>
                	</tr>
                	<tr>
                		<td class="td-text">身份证：</td>
                		<input type="hidden" name="teacherId" th:value="${user.teacher}==null?'':${user.teacher.teacherId}"></input>
                		<input type="hidden" name="id" th:value="${user.userId}"></input>
                		<input type="hidden" name="userType" th:value="${user.userType}"></input>
                		<input  type="hidden" id="province" th:value="${user.teacher}==null?'':${user.teacher.province}"></input>
				        <input  type="hidden" id="city" th:value="${user.teacher}==null?'':${user.teacher.city}"></input>
				        <input  type="hidden" id="area" th:value="${user.teacher}==null?'':${user.teacher.area}"></input>
				        <input  type="hidden" id="highDegree" th:value="${user.teacher}==null?'':${user.teacher.highDegree}"></input> 
				        <input  type="hidden" id="jobTitle" th:value="${user.teacher}==null?'':${user.teacher.jobTitle}" ></input>          	
                		<td class="td-sr"><input class="td-input input85 td-border" type="text" id="idNumber"  th:value="${user.teacher.idNumber}==null?'':${user.teacher.idNumber}"  name="idNumber" disabled="true" onblur="checkIdNumber()"></input></td>
                		<td class="td-text" id="idNumberMessage"></td>
                	</tr>
                	<tr>
                		<td class="td-text">职工号：</td>
                		<td class="td-sr"><input class="td-input input85 td-border" type="text" id="jobNum" th:value="${user.teacher}==null?'':${user.teacher.jobNum}" name="jobNum" disabled="true"></input></td>
                	</tr>
                	  <tr>
                		<td class="td-text">职称：</td>
                		<td class="td-sr"><select name="jobTitle"  id="titleSelect"  class="select-ss" title="" required="" disabled="true"></select></td>
                	</tr>
                	 <tr>
                		<td class="td-text">最高学历：</td>
                		<td class="td-sr"><select name="highDegree"  id="degreeSelect" class="select-ss" title="" required="" disabled="true"></select></td>
                	</tr>
                	 <tr>
                		<td class="td-text">地址：</td>
                		<td class="td-sr">
                		<select name="province" 
                		        class="select-s" 
                		        title="" 
                		        required="" disabled="true">
                		</select>
                        <select
                            name="city"
                            class="select-s"
                            title=""
                            required="" disabled="true">
                         </select>
                        <select
                            name="area"
                            class="select-s"
                            title=""
                            required="" disabled="true">
                        </select>
                		</td>
                	</tr>
                	<tr>
                		<td class="td-text">街道：</td>
                		<td class="td-sr"><input class="td-input input85 td-border" type="text" id="addr" th:value="${user.teacher}==null?'':${user.teacher.addr}" name="addr" disabled="true"></input></td>
                	</tr>
                	</tbody>
                </table>
                <h4 class="gray">*选填</h4>
                <table class="required">
                	<tbody>
                	<tr>
                		<td class="td-text">头像：</td>
                		<td class="td-sr red">*仅支持jpg、png格式，文件小于1M（方形图）</td>
                		<td class="gray td-zs"></td>
                	</tr>
                	<tr>
                		<td class="td-text"></td>                                                                                                                           
                		<td>
                		    <img th:src="${user.imgSrc}==null?'':${user.imgSrc}" src="img/tx-u.png" id ="img" class="send-img"/>
                		    <!-- <input type="file" value="选择文件" id="upload-file" name="file"/> -->
                		    <a href="#" class="file-pic">选择文件
                                <input type="file" name="file" id="upload-file" disabled="true"/>
                            </a>
                		</td>
                		<td class="gray td-zs"></td>
                	</tr>
                	<tr>
                		<td class="td-text">老师介绍：</td>
                		<td class="td-sr red"><textarea class="tes-input" clos="20" rows="3"  disabled="true" id="introduction" name="teacherIntroduction" th:text="${user.teacher}==null?'':${user.teacher.teacherIntroduction}"></textarea></td>
                		<td class="gray td-zs"></td>
                	</tr>
                	</tbody>
                </table>
                <div class="sav-u">
                    <p class="savss">
                	<input class="blue" id="save" type="button" style="visibility: hidden;" value="保存" />
                	<input class="grays" id="quit" type="button"  style="visibility: hidden;" value="取消" />
                    </p>
                </div>
                </form>
                <iframe name='hidden_frame' id="hidden_frame" style='display: none'></iframe>

<script th:src="@{/AdminBackend/js/ly-lib/ly-selector-ssx-no-lodash.js}"></script>
<script th:src="@{/AdminBackend/js/ly-lib/ly-helper-tools.js}"></script>
<script th:src="@{/AdminBackend/js/ly-lib/selectFirst.js}"></script>
<script type="text/javascript">
$('#hidden_frame').load(function(){
    var text=$(this).contents().find("body").text();
       // 根据后台返回值处理结果
    var j=$.parseJSON(text);
    if(j.result=="success") {
        alert("修改成功");
		$("div[id='saidpanel']").load('/personalcenter/personinfor');
    } 
    else if(j.result=="fail"){
    	alert("修改失败");
    }  
});
 
	$(document).ready(function() {
	
		$(".fortab").click(function() {
			var number = $(".fortab").index(this);
			$(this).addClass("checked");
			$(this).siblings().removeClass("checked");
			$(".tablelist:eq(" + number + ")").show();
			$(".tablelist:eq(" + number + ")").siblings().hide();
		});
	});

	function makeEditable() {
		document.getElementById("save").style.visibility = "visible";
		document.getElementById("quit").style.visibility = "visible";
		document.getElementById("edit").style.display = "none";
		$("#nickName").attr("disabled", false);
		$("#name").attr("disabled", false);
		$("#phone").attr("disabled", false);
		$("#email").attr("disabled", false);
		$("#idNumber").attr("disabled", false);
		$("#male").attr("disabled", false);
		$("#female").attr("disabled", false);
		$("#jobNum").attr("disabled", false);
		$("#jobTitle").attr("disabled", false);
		$("#highDegree").attr("disabled", false);
		$("#province").attr("disabled", false);
		$("#city").attr("disabled", false);
		$("#area").attr("disabled", false);
		$("#addr").attr("disabled", false);
		$("#introduction").attr("disabled", false);
		$("#titleSelect").attr("disabled", false);
		$("#degreeSelect").attr("disabled", false);
		$("#upload-file").attr("disabled", false);
		$("select[name='province']").attr("disabled", false);
		$("select[name='city']").attr("disabled", false);
		$("select[name='area']").attr("disabled", false);
	} 

	function checkName(){
		  var check; 
	      var reg=/^[\u4E00-\u9FA5]{1,6}$/;
	      var name = document.getElementById("name").value;   
		   if(reg.test(name)==false){
			 $("#nameMessage").attr("class","red");
			 document.getElementById("nameMessage").innerHTML = "*姓名格式不正确";
			   check = false; 
			}else{ 
			$("#nameMessage").attr("class","green");
		    document.getElementById("nameMessage").innerHTML = "*姓名格式正确";
			  check = true; 
	      }
	      return check; 
	   }
	

	function checkPhone(){
		  var check; 
	      var reg=/^0?(12[0-9]|13[0-9]|14[57]|15[012356789]|16[0-9]|17[0-9]|18[0-9]|19[0-9])[0-9]{8}$/;
	      var phone = document.getElementById("phone").value;   
		   if(reg.test(phone)==false){
			 $("#phoneMessage").attr("class","red");
			 document.getElementById("phoneMessage").innerHTML = "*手机格式不正确";
			   check = false; 
			}else{ 
			$("#phoneMessage").attr("class","green");
		    document.getElementById("phoneMessage").innerHTML = "*手机格式正确";
			  check = true; 
	      }
	  
	      return check; 
	}
	
	function checkEmail(){
		  var check; 
	      var reg=/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/;
	      var email = document.getElementById("email").value;   
		   if(reg.test(email)==false){
			 $("#emailMessage").attr("class","red");
			 document.getElementById("emailMessage").innerHTML = "*邮箱格式不正确";
			   check = false; 
			}else{ 
			$("#emailMessage").attr("class","green");
		    document.getElementById("emailMessage").innerHTML = "*邮箱格式正确";
			  check = true; 
	      }
	  
	      return check; 
		
	}
	
	
	function checkIdNumber(){
		  var check; 
		  var reg = /(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;  
	      var idNumber = document.getElementById("idNumber").value;   
		   if(reg.test(idNumber)==false){
			 $("#idNumberMessage").attr("class","red");
			 document.getElementById("idNumberMessage").innerHTML = "身份证格式不正确";
			   check = false; 
			}else{ 
			$("#idNumberMessage").attr("class","green");
		    document.getElementById("idNumberMessage").innerHTML = "*身份证格式正确";
			  check = true; 
	      }
	  
	      return check; 
		
	}
	
	 $('#save').click(function(){
		 /*<![CDATA[*/
       if(checkName() && checkPhone() && checkEmail() && checkIdNumber()){
         $('#teacherForm').submit();
        /*]]>*/ 
       }else{
      	 alert("所填内容不规范")
         return false;
       }
     });
	 
	
	 $('#quit').click(function(){
			$("div[id='saidpanel']").load('/personalcenter/personinfor');
    });
	
 document.querySelector('#upload-file').addEventListener('change', function(){
	        //当没选中图片时，清除预览
	        if(this.files.length === 0){
	            document.querySelector('#img').src = '';
	            return;
	        }
	        
	        //实例化一个FileReader
	        var reader = new FileReader();

	        reader.onload = function (e) {
	            //当reader加载时，把图片的内容赋值给
	            document.querySelector('#img').src = e.target.result;
	        };

	    //读取选中的图片，并转换成dataURL格式
	    reader.readAsDataURL(this.files[0]);
	    }, false);

 var SSXSelectorManager = document.LY.LySelectorSSX.createManager(
         $("select[name='province']"),
         $("select[name='city']"),
         $("select[name='area']")
     );

 SSXSelectorManager.resetSelected($("#province").val(),$("#city").val(),$("#area").val()); 

</script>

        
			